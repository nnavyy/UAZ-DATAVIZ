---
title: "UAS Visualisasi Data"
author: "Nanda Zhafran Mahendra"
date: "`r Sys.Date()`"
output: html_document
css: styles.css

---
# Pendahuluan

Tugas UAS ini bertujuan untuk mengukur kemampuan dalam membuat visualisasi data yang informatif menggunakan R Markdown. Dataset yang digunakan berasal dari file `Data.xlsx`.

- **Nama**: Nanda ZHafran Mahendra
- **NIM**:  A3202300035
- **Tujuan Analisis**: Memberikan pemahaman visual dari data dengan berbagai jenis grafik.

## Struktur Folder

Proyek ini mengikuti struktur sebagai berikut:

```
project/
├── data/       
├── figures/  
├── docs/       
├── script/     
└── styles.css  
```

## Persiapan Data
```{r setup, include=FALSE}
library(readr)
library(readxl)
library(ggplot2)
library(plotly)
library(dplyr)
library(tidyverse)
library(gganimate)
library(gapminder)
library(htmlwidgets)

print(getwd())
print(file.exists("styles.css"))

# Membaca dataset
setwd("C:/Users/ACER/OneDrive/Documents/UAZ DATAVIZ")
data <- read_xlsx("data.xlsx")
print(data)

knitr::opts_chunk$set(echo = TRUE)

# Periksa nama kolom untuk memastikan
print(names(data))
summary(data)
print(names(data))

```

```{r}
# Validasi file dan membaca dataset
setwd("C:/Users/ACER/OneDrive/Documents/UAZ DATAVIZ")
if (!file.exists("data.xlsx")) {
  stop("File data.xlsx tidak ditemukan. Pastikan file berada di direktori yang benar.")
}

data <- read_xlsx("data.xlsx")

required_columns <- c("Pendapatan_per_kapita", "Angka_Harapan_Hidup")
if (!all(required_columns %in% names(data))) {
  stop("Beberapa kolom yang diperlukan tidak ditemukan di dataset.")
}
```

## Visualisasi Data

### 1. Grafik Univariat: Histogram

```{r}
print(names(data))

```
### a. Distribusi Angka Harapan Hidup
Grafik berikut menunjukkan distribusi angka harapan hidup dalam dataset. Histogram ini membantu kita memahami persebaran nilai, termasuk apakah data condong ke kanan, ke kiri, atau simetris.

```{r histogram}
# Histogram untuk variabel numerik
p1 <- ggplot(data, aes(x=Angka_Harapan_Hidup)) +  # Gunakan backticks jika ada spasi di nama kolom
  geom_histogram(binwidth = 5, fill = "skyblue", color = "black") +
  labs(title = "Distribusi Angka Harapan Hidup",
       x = "Angka_Harapan_Hidup",
       y = "Frekuensi") +
  theme_minimal()
if (!dir.exists("figures")) dir.create("figures")
ggsave("figures/scatterplot.png", p1)
print(p1)
```

### b. Distribusi Pendapatan per Kapita
Grafik berikut menunjukkan distribusi pendapatan per kapita. Grafik ini penting untuk melihat pola umum, seperti adanya outlier atau pola tertentu pada data.

```{r histogram2}
p2 <- ggplot(data, aes(x = Pendapatan_per_kapita)) +
  geom_histogram(binwidth = 2100, fill = "lightgreen", color = "black") +
  labs(title = "Distribusi Pendapatan per Kapita",
       x = "Pendapatan per Kapita",
       y = "Frekuensi") +
  theme_minimal()
ggsave("figures/histogram2.png", p2)
print(p2)
```

### 2. Grafik Bivariat: Scatter Plot
### a. Hubungan antara Pendapatan per Kapita dan Angka Harapan Hidup
Scatter plot berikut menunjukkan hubungan antara pendapatan per kapita dan angka harapan hidup. Grafik ini membantu melihat apakah ada pola hubungan linear, seperti semakin tinggi pendapatan, semakin tinggi angka harapan hidup.


```{r scatter}
p2 <- ggplot(data, aes(x = Pendapatan_per_kapita, y = `Angka_Harapan_Hidup`)) +
  geom_point(color = "darkred", alpha = 0.5) +
  labs(title = "Hubungan antara Pendapatan per Kapita dan Angka Harapan Hidup",
       x = "Pendapatan_per_Kapita",
       y = "Angka_Harapan_Hidup") +
  theme_minimal()

ggsave("figures/scatterplot2.png", p2)
print(p2)
```




### 3. Grafik Multivariat: Bubble Plot
Populasi sebagai ukuran gelembung dan Benua sebagai kategori warna.
```{r bubbleplot}
p3 <- ggplot(data, aes(x = Angka_Harapan_Hidup, 
                       y = `Pendapatan_per_kapita`, 
                       size = Populasi, color = Benua)) +
  geom_point(alpha = 0.5) +
  scale_size(range = c(2, 12)) +
  labs(title = "Hubungan Multivariat Antar Variabel",
       x = "Angka Harapan Hidup",
       y = "Pendapatan per Kapita",
       size = "Populasi",
       color = "Benua") +
  theme_minimal()

ggsave("figures/bubbleplot.png", p3)
print(p3)
```



### 4. Grafik Interaktif: Scatter Plot dengan Plotly
A. pembaca dapat mengeksplorasi hubungan antar variabel secara langsung.
```{r plotly_scatter}
p4 <- plot_ly(data, x = ~Angka_Harapan_Hidup, 
              y = ~`Pendapatan_per_kapita`, 
              type = 'scatter', 
              mode = 'markers', 
              marker = list(size = 4, color = ~as.factor(Benua))) %>%
  layout(title = "Scatter Plot Interaktif",
         xaxis = list(title = "Angka Harapan Hidup"),
         yaxis = list(title = "Pendapatan per Kapita"))

htmlwidgets::saveWidget(as_widget(p4), "figures/plotly_scatter.html")

p4
```

B. Grafik interaktif 3D
```{r interactive, results='asis'}
p4 <- plot_ly(data, x = ~`Pendapatan_per_kapita`, y = ~`Angka_Harapan_Hidup`, z = ~Populasi,
              type = "scatter3d", mode = "markers",
              marker = list(size = 5, color = ~Populasi, colorscale = "Viridis"))

p4
```

### 5. Grafik Dinamis: Gapminder Animation
perubahan indikator sosial-ekonomi global dari waktu ke waktu.
```{r gganimate}
p5 <- ggplot(gapminder, aes(x = gdpPercap, 
                            y = lifeExp, 
                            size = pop, 
                            color = continent)) +
  geom_point(alpha = 0.7) +
  scale_x_log10() +
  labs(title = "Gapminder: Perubahan dari Tahun ke Tahun",
       x = "Pendapatan per Kapita (log scale)",
       y = "Angka Harapan Hidup",
       size = "Populasi",
       color = "Benua") +
  theme_minimal() +
  gganimate::transition_states(year, transition_length = 2, state_length = 1) +
  gganimate::enter_fade() +
  gganimate::exit_fade() +
  labs(subtitle = "Tahun: {closest_state}")

anim <- gganimate::animate(p5, nframes = 100, renderer = gganimate::gifski_renderer())

gganimate::anim_save("gapminder_animation.gif", animation = anim)

knitr::include_graphics("gapminder_animation.gif")



```


```{r gganimate2}
required_columns <- c("Pendapatan_per_kapita", "Angka_Harapan_Hidup", "Populasi", "Benua", "Tahun")
if (!all(required_columns %in% names(data))) {
  stop("Beberapa kolom yang diperlukan tidak ditemukan di dataset.")
}

anim_plot <- ggplot(data, aes(x = Pendapatan_per_kapita, 
                              y = Angka_Harapan_Hidup, 
                              size = Populasi, 
                              color = Benua)) +
  geom_point(alpha = 0.6) +
  scale_x_log10() + 
  labs(title = "Perubahan Berdasarkan Tahun dan Benua",
       subtitle = "Tahun: {closest_state}",
       x = "Pendapatan per Kapita (log scale)",
       y = "Angka Harapan Hidup",
       size = "Populasi",
       color = "Benua") +
  theme_minimal() +
  theme(legend.position = "bottom") +
  gganimate::transition_states(Tahun, transition_length = 2, state_length = 1) +
  gganimate::enter_fade() +
  gganimate::exit_fade() +
  facet_wrap(~ Benua)
anim <- animate(anim_plot, nframes = 100, fps = 12, width = 1200, height = 1000,
renderer = gifski_renderer())

anim_save("figures/animasi_benua.gif", animation = anim)

knitr::include_graphics("figures/animasi_benua.gif")

```


